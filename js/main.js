/*! extempore-docs-website 2015-09-16 */
"use strict";var MAX_DOCS_SHOWN=50,DocumentBox=React.createClass({displayName:"DocumentBox",getInitialState:function(){return{status:"",currentData:[],fullData:[],searchTerm:"",categories:[{name:"builtin",active:!0},{name:"polymorphic closure",active:!0},{name:"closure",active:!0},{name:"scheme closure",active:!0},{name:"type alias",active:!0},{name:"named type",active:!0},{name:"generic closure",active:!0},{name:"global var",active:!0}]}},componentDidMount:function(){var a=this,b=new XMLHttpRequest;b.open("GET",this.props.url,!0),b.onload=function(c){var d=JSON.parse(b.responseText),e=_.sortBy(d,function(a){return a.name.toLowerCase()});a.setState({fullData:e}),a.updateDocsList()},b.send(),window.location.hash&&this.setState({searchTerm:window.location.hash.slice(1)}),window.onpopstate=function(b){a.setState({searchTerm:window.location.hash.slice(1)})}},render:function(){return React.createElement("div",{className:"documentBox"},React.createElement("h1",null,"Extempore Documentation"),React.createElement(SearchForm,{onSearchUpdate:this.handleSearchTerm,onCategoryUpdate:this.handleCategoryUpdate,categories:this.state.categories,searchTerm:this.state.searchTerm}),React.createElement(DocumentStatus,{status:this.state.status}),React.createElement(DocumentList,{data:this.state.currentData}))},handleCategoryUpdate:function(a,b){var c=_.map(this.state.categories,function(c){return c.name==b?{name:c.name,active:a}:c});this.setState({categories:c})},handleSearchTerm:function(a){history.pushState?history.pushState(null,null,"#"+a):location.hash="#"+a,this.setState({searchTerm:a})},componentDidUpdate:function(a,b){b.searchTerm!==this.state.searchTerm?this.updateDocsList():_.isEqual(b.categories,this.state.categories)||this.updateDocsList()},updateDocsList:function(){var a,b=this,c=_.chain(this.state.fullData).filter(function(a){return _.startsWith(a.name.toLowerCase(),b.state.searchTerm.toLowerCase())}).filter(function(a){var c=_.chain(b.state.categories).filter("active").pluck("name").value();return _.contains(c,a.category)}).value();c.length>MAX_DOCS_SHOWN?(a=_.slice(c,0,MAX_DOCS_SHOWN),this.setState({status:"Showing "+MAX_DOCS_SHOWN+" records out of "+c.length})):(a=c,0==c.length?this.setState({status:"No records found"}):this.setState({status:""})),this.setState({currentData:a})}}),DocumentStatus=React.createClass({displayName:"DocumentStatus",render:function(){return React.createElement("div",{className:"documentStatus"},this.props.status)}}),DocumentList=React.createClass({displayName:"DocumentList",render:function(){var a=this.props.data.map(function(a,b){return React.createElement(DocumentItem,{key:a.category+" "+a.name,category:a.category,name:a.name,args:a.args,type:a.type,docstring:a.docstring,odd:b%2===1})});return React.createElement("div",{className:"documentList"},a)}}),DocumentItem=React.createClass({displayName:"DocumentItem",fragmentPoly:function(a){if(a.docstringPoly.length>0){var b=a.docstringPoly.map(function(a,b){var c="#"+a[0];return React.createElement("p",{key:a[0]}," ",React.createElement("a",{href:c},a[0],":",a[1]))});return React.createElement("tr",null,React.createElement("td",{className:"col-md-2 description"},"Poly"),React.createElement("td",null,b))}return void 0},fragmentSees:function(a){if(a.docstringSees.length>0){var b=a.docstringSees.map(function(a,b){var c="#"+a[0];return React.createElement("p",null," ",React.createElement("a",{href:c},a[0]," - ",a[1]))});return React.createElement("tr",null,React.createElement("td",{className:"col-md-2 description"},"See"),React.createElement("td",null,b))}return void 0},fragmentReturns:function(a){if(_.isNull(this.props.args))return void 0;this.props.args[0];return a.docstringReturn.length>0?React.createElement("tr",null,React.createElement("td",{className:"description"},"Returns"),React.createElement("td",null,React.createElement("p",null," ",a.returns," "))):void 0},fragmentParams:function(a){if(_.isNull(this.props.args)||this.props.args.length<2)return void 0;var b=this.props.args.slice(1),c=[];return b.forEach(function(b,d){var e=_.chain(a.docstringParams).filter(function(a,c){return a[0]===b[0]}).pluck(1).first().value();c.push(React.createElement("tr",{key:d},React.createElement("td",{className:"code"},b[0]),React.createElement("td",{className:"code"},b[1]),React.createElement("td",null,e)))}),React.createElement("tr",null,React.createElement("td",{className:"col-md-2 description"}," Parameters "),React.createElement("td",null,React.createElement("table",{className:"table"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",null,"Parameter Name"),React.createElement("th",null,"Type"),React.createElement("th",null,"Parameter Description"))),React.createElement("tbody",null,c))))},fragmentExample:function(a){if(a.docstringExamples.length>0){var b=a.docstringExamples.map(function(a,b){return React.createElement("p",{key:b},React.createElement("code",null,a))});return React.createElement("tr",null,React.createElement("td",{className:"col-md-2 description"},"Examples"),React.createElement("td",null,b))}return void 0},fragmentDescription:function(a){return a.longDescription.length>0?React.createElement("tr",null,React.createElement("td",{className:"col-md-2 description"},React.createElement("p",null,"Long Description")),React.createElement("td",null,React.createElement("p",null,a.longDescription))):void 0},renderCallable:function(){var a=parseDocstring(this.props.docstring||""),b=this.fragmentDescription(a),c=this.fragmentParams(a),d=this.fragmentReturns(a),e=this.fragmentSees(a),f=this.fragmentExample(a);return React.createElement("tbody",null,b,c,d,e,f)},renderNonCallables:function(){var a=parseDocstring(this.props.docstring||""),b=this.fragmentDescription(a);return React.createElement("tbody",null,b)},renderPolyClosure:function(){var a=parseDocstring(this.props.docstring||""),b=this.fragmentDescription(a),c=this.fragmentSees(a),d=this.fragmentPoly(a);return React.createElement("tbody",null,b,d,c)},render:function(){var a,b=parseDocstring(this.props.docstring||""),c=React.createElement("h2",{className:"documentName code"},this.props.name,React.createElement("span",{className:"documentCategory"},this.props.category));_.contains(["builtin","closure","named type","generic closure","scheme closure"],this.props.category)?a=this.renderCallable():"type alias"===this.props.category||"global var"===this.props.category?a=this.renderNonCallables():"polymorphic closure"===this.props.category&&(a=this.renderPolyClosure());var d="documentItem";return this.props.odd&&(d+=" odd"),React.createElement("div",{className:d},c,React.createElement("p",null,b.shortDescription),React.createElement("table",{className:"table table-bordered"},React.createElement("thead",null),a))}}),SearchForm=React.createClass({displayName:"SearchForm",render:function(){var a=this,b=this.props.categories.map(function(b){return React.createElement(CategoryButton,{key:b.name,name:b.name,active:b.active,onCategoryChange:a.handleCategoryUpdate})});return React.createElement("div",{className:"form-group"},React.createElement("form",{className:"searchForm",onSubmit:this.handleSubmit},React.createElement("div",{className:"form-group"},React.createElement("input",{type:"text",ref:"term",className:"form-control",placeholder:"Search",onChange:this.handleOnChange,value:this.props.searchTerm}))," ",React.createElement("div",{className:"form-group"},React.createElement("div",{className:"btn-group","data-toggle":"buttons"},b)," ")," "))},handleOnChange:function(a){this.props.onSearchUpdate(a.target.value)},handleCategoryUpdate:function(a,b){this.props.onCategoryUpdate(a,b)},handleSubmit:function(a){a.preventDefault()}}),CategoryButton=React.createClass({displayName:"CategoryButton",getInitialState:function(){return{active:this.props.active}},handleChange:function(a){this.setState({active:!this.state.active},function(){this.props.onCategoryChange(this.state.active,this.props.name)})},handleFocus:function(a){React.findDOMNode(this).blur()},render:function(){var a="categoryButton btn btn-primary btn-sm ";return this.state.active&&(a+="active"),React.createElement("button",{tabIndex:"-1",className:a,onFocus:this.handleFocus,onClick:this.handleChange},this.props.name)}});React.render(React.createElement(DocumentBox,{url:"xtmdoc.json"}),document.getElementById("content"));var parseType=function(a){var b=void 0,c=[],d=[],e="";if("["!==a[0]&&"<"!==a[0])return[a];var f={start:function(a){return f.readType},simpleType:function(a){return e+=a,f.simpleType},readType:function(a){return e+=a,_.contains(["[","<","/"],a)?(c.push(a),f.withinNestedType):"|"===a?0===e.length?(c.push(a),f.withinNestedType):f.readType:","===a?(e=e.substring(0,e.length-1),d.push(e),e="",f.readType):"]"===a?(e=e.substring(0,e.length-1),d.push(e),f.finish):">"===a?(e=e.substring(0,e.length-1),d.push(e),f.finish):f.readType},withinNestedType:function(a){var b=c[c.length-1];if(e+=a,_.contains(["[","<"],a))return c.push(a),f.withinNestedType;switch(a){case"]":return c.pop(),0===c.length?f.readType:f.withinNestedType;case">":return c.pop(),0===c.length?f.readType:f.withinNestedType;case"|":return"|"===b?(c.pop(),0===c.length?f.readType:f.withinNestedType):(c.push("|"),f.withinNestedType);case"/":return"/"===b?(c.pop(),0===c.length?f.readType:f.withinNestedType):(c.push("/"),f.withinNestedType);default:return f.withinNestedType}},finish:function(a){return f.finish}};b=f.start;for(var g=0;g<a.length;g++)b=b(a[g]);return d},SHORT_DESCRIPTION_RE=/^(.*)(\n|$)/,LONG_DESCRIPTION_RE=/(?:[\n\r]+)(?!@)([\w\s\S]*?)(?:(\n+@)|$)/,DOCSTRING_PARAM=/@param(?: )?(\w*)? - (.*)/gm,DOCSTRING_RETURN=/@return(?:.*?) - (.*)/gm,DOCSTRING_SEE=/@see (.*?) - (.*)/g,DOCSTRING_POLY=/@poly (.*?):(.*)/g,DOCSTRING_EXAMPLE=/@example([\w\s\S]*?)(\n@|$)/g,parseDocstring=function(a){for(var b,c=[],d=[],e=[],f=[];null!==(b=DOCSTRING_PARAM.exec(a));)c.push([b[1]||"",b[2]]);for(;null!==(b=DOCSTRING_SEE.exec(a));)d.push([b[1],b[2]]);for(;null!==(b=DOCSTRING_EXAMPLE.exec(a));)e.push(b[1]);for(;null!==(b=DOCSTRING_POLY.exec(a));)f.push([b[1],b[2]]);return{shortDescription:_.get(SHORT_DESCRIPTION_RE.exec(a),1,""),longDescription:_.get(LONG_DESCRIPTION_RE.exec(a),1,""),docstringParams:c,docstringReturn:_.get(DOCSTRING_RETURN.exec(a),1,""),docstringSees:d,docstringExamples:e,docstringPoly:f}};